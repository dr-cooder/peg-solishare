(()=>{var t={303:(t,e,n)=>{const{emptyBoard:r,width:a,height:o,validMoveDeltas:i,validMoveDeltaCount:s,isCode:l,isPuzzle:c,codeToPuzzle:d,puzzleToCode:u,defaultCodeBase:y,countBalls:h,validateMoveStruct:p}=n(175);t.exports=class{constructor(t){t?c(t)?this.puzzle=t:l(t)?this.puzzle=d(t):l(t,2)?this.puzzle=d(t,2):this.puzzle=r():this.puzzle=r(),this.moveHistory=[]}validateMove(t,e){if(!p(t))return null;const n=t.from.x,r=t.from.y,l=t.to.x,c=t.to.y,d=l-n,u=c-r;let y=null;for(let t=0;t<s;t++){const e=i[t];e.x===d&&e.y===u&&(y=e)}if(!y)return null;const h=y.middle,f=n+h.x,m=r+h.y;if(n<0||n>=a)return null;if(r<0||r>=o)return null;if(l<0||l>=a)return null;if(c<0||c>=o)return null;const w=e?0:1,A=e?0:1,g=e?1:0;return this.puzzle[r][n]!==w||this.puzzle[m][f]!==A||this.puzzle[c][l]!==g?null:{matchingDelta:y,moveMid:{x:f,y:m}}}allValidMoves(t){const e=[];for(let n=0;n<o;n++)for(let r=0;r<a;r++)if(1===this.puzzle[n][r])for(let a=0;a<s;a++){const o=i[a],s=t?{from:{x:r-o.x,y:n-o.y},to:{x:r,y:n}}:{from:{x:r,y:n},to:{x:r+o.x,y:n+o.y}};this.validateMove(s,t)&&e.push(s)}return e}makeMove(t,e,n){const r=this.validateMove(t,e);if(!r)return!1;const{moveMid:a}=r,o=t.from,i=t.to,s=e?1:0,l=e?1:0,c=e?0:1;return this.puzzle[o.y][o.x]=s,this.puzzle[a.y][a.x]=l,this.puzzle[i.y][i.x]=c,n||this.moveHistory.push(t),!0}undo(t){this.makeMove(this.moveHistory.pop(),!t,!0)}countBalls(){return h(this.puzzle)}puzzleToString(){return this.puzzle.map((t=>Array.from(t).map((t=>[".","O"," "][t])).join(" "))).join("\n")}code(t=y){return u(this.puzzle,t)}}},273:(t,e,n)=>{const{Component:r,createRef:a}=React,{distanceNoSqrt:o}=n(718),i=n(303),{emptyBoard:s,width:l,height:c,defaultCodeBase:d,validateMoveStruct:u}=n(175);t.exports=class extends r{constructor(t){super(t),this.state={disabled:!1,holdingBall:!1},this.canvasRef=a(),this.canvasOuterRef=a(),this.game=new i(t.basis),this.code=(t=d)=>this.game.code(t),this.undo=t=>{this.game.undo(t),this.hintOnDisplay=null,this.props.onMove()},this.hintOnDisplay=null,this.displayHint=t=>{u(t)&&(this.hintOnDisplay=t)}}static getDerivedStateFromProps(t,e){return t.disabled!==e.disabled?{disabled:t.disabled,holdingBall:!t.disabled&&e.holdingBall}:null}componentDidMount(){const t=this.canvasRef.current,e=t.width,n=t.height,r=this.canvasOuterRef.current,a=t.getContext("2d"),i=s(),d=400/l,u=400/c,y=[];for(let t=0;t<c;t++){const e=[],n=u*(t+.5)+100,r=u*t+100;for(let a=0;a<l;a++)2!==i[t][a]&&(e[a]={x:d*(a+.5)+100,y:n,left:d*a+100,top:r});y[t]=e}let h=e/2,p=n/2;const f=e=>{if(!e)return;let n,a;const o=e.type.slice(0,5);"touch"===o?(n=e.touches[0].pageX,a=e.touches[0].pageY):"mouse"===o&&(n=e.pageX,a=e.pageY),h=(n-r.offsetLeft)*(t.width/r.offsetWidth),p=(a-r.offsetTop)*(t.height/r.offsetHeight)};let m=Math.floor(l/2),w=Math.floor(c/2);const A=t=>{f(t),m=Math.floor((h-100)/d),w=Math.floor((p-100)/u)};let g=0,U=0;const v=t=>{if(this.state.disabled)return;A(t);const e=this.game.puzzle[w];if(e&&1===e[m]){const t=y[w][m];o(h,p,t.x,t.y)<400&&(this.setState({holdingBall:!0}),g=m,U=w)}},z=t=>{if(this.state.disabled||!this.state.holdingBall)return;this.setState({holdingBall:!1}),A(t);const e={from:{x:g,y:U},to:{x:m,y:w}};this.game.makeMove(e)&&(this.hintOnDisplay=null,this.props.onMove())};r.onmousedown=v,r.onmousemove=f,r.onmouseup=z,r.onmouseout=z,r.ontouchstart=v,r.ontouchmove=f,r.ontouchend=z,r.ontouchcancel=z;const b=()=>{requestAnimationFrame(b),a.clearRect(0,0,e,n),a.lineWidth=3,a.lineJoin="miter",a.strokeStyle="black",a.fillStyle="black";for(let t=0;t<c;t++)for(let e=0;e<l;e++){const n=y[t][e];n&&(a.beginPath(),a.rect(n.left,n.top,d,u),a.closePath(),a.stroke(),1!==this.game.puzzle[t][e]||this.state.holdingBall&&e===g&&t===U||(a.beginPath(),a.arc(n.x,n.y,20,0,2*Math.PI),a.closePath(),a.fill()))}if(this.hintOnDisplay){a.lineWidth=6,a.lineJoin="round",a.strokeStyle="deepskyblue";const t=this.hintOnDisplay.from,e=y[t.y][t.x];a.beginPath(),a.rect(e.left,e.top,d,u),a.closePath(),a.stroke();const n=this.hintOnDisplay.to,r=y[n.y][n.x];a.beginPath(),a.rect(r.left,r.top,d,u),a.closePath(),a.stroke()}this.state.holdingBall&&(a.fillStyle="red",a.beginPath(),a.arc(h,p,20,0,2*Math.PI),a.closePath(),a.fill())};b()}render(){return React.createElement("div",{ref:this.canvasOuterRef,className:"gameBoardCanvasOuter"},React.createElement("div",{className:"ratio1x1"},React.createElement("div",{className:"ratioContainer"},React.createElement("canvas",{ref:this.canvasRef,className:"gameBoardCanvas",width:"600",height:"600"}))))}}},718:t=>{const e=t=>{const e=Math.floor(t/36e5),n=Math.floor(t/6e4)%60,r=Math.floor(t/1e3)%60,a=t%1e3;return`${e.toString().padStart(2,"0")}:${n.toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}.${a.toString().padStart(3,"0")}`};t.exports={distanceNoSqrt:(t,e,n,r)=>{const a=n-t,o=r-e;return a*a+o*o},byteToBits:t=>t.toString(2).padStart(8,"0"),byteFromBitRemainder:t=>parseInt(t.padEnd(8,"0"),2),formatTime:e,progressPercent:(t,e)=>{const n=t.toString().padStart(2,"0").padStart(4," "),r=` [32m${n.slice(0,-1)}.${n.slice(-1)}%[39m`;process.stdout.cursorTo(e),process.stdout.write(r)},doneHavingStartedAt:t=>{const n=Date.now()-t;process.stdout.write(`\nDone after ${e(n)}\n`)}}},175:t=>{const e=()=>{const t=[new Uint8Array([2,2,0,0,0,2,2]),new Uint8Array([2,2,0,0,0,2,2]),new Uint8Array([0,0,0,0,0,0,0]),new Uint8Array([0,0,0,0,0,0,0]),new Uint8Array([0,0,0,0,0,0,0]),new Uint8Array([2,2,0,0,0,2,2]),new Uint8Array([2,2,0,0,0,2,2])];return Object.seal(t),t},n=[[2,1,0,5,4,3,12,11,10,9,8,7,6,19,18,17,16,15,14,13,26,25,24,23,22,21,20,29,28,27,32,31,30],[30,31,32,27,28,29,20,21,22,23,24,25,26,13,14,15,16,17,18,19,6,7,8,9,10,11,12,3,4,5,0,1,2],[32,31,30,29,28,27,26,25,24,23,22,21,20,19,18,17,16,15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,0],[6,13,20,7,14,21,0,3,8,15,22,27,30,1,4,9,16,23,28,31,2,5,10,17,24,29,32,11,18,25,12,19,26],[26,19,12,25,18,11,32,29,24,17,10,5,2,31,28,23,16,9,4,1,30,27,22,15,8,3,0,21,14,7,20,13,6],[12,19,26,11,18,25,2,5,10,17,24,29,32,1,4,9,16,23,28,31,0,3,8,15,22,27,30,7,14,21,6,13,20],[20,13,6,21,14,7,30,27,22,15,8,3,0,31,28,23,16,9,4,1,32,29,24,17,10,5,2,25,18,11,26,19,12]],r=n.length,a=(t,e)=>{const r=n[e];let a="";for(let e=0;e<33;e++)a+=t.charAt(r[e]);return a},o=parseInt("1".repeat(33),2),i=[];for(let t=2;t<=36;t++)i[t]=(s=t,o.toString(s).length);var s;const l=(t,e,n)=>parseInt(t,e).toString(n).padStart(i[n],"0"),c=[];for(let t=2;t<=36;t++)c[t]=new RegExp(`^[${"0123456789abcdefghijklmnopqrstuvwxyz".slice(0,t)}]{${i[t]}}$`);const d=[4,8,10,14,18,22,24,28],u=d.length,y=2**u;t.exports={emptyBoard:e,width:7,height:7,slotCount:33,validMoveDeltas:[{name:"right",x:2,y:0,middle:{x:1,y:0}},{name:"up",x:0,y:-2,middle:{x:0,y:-1}},{name:"left",x:-2,y:0,middle:{x:-1,y:0}},{name:"down",x:0,y:2,middle:{x:0,y:1}}],validMoveDeltaCount:4,isCode:(t,e=16)=>c[e].test(t),isPuzzle:t=>{if(!t)return!1;const n=e();if(!Array.isArray(t))return!1;const r=t.length;if(7!==r)return!1;for(let e=0;e<r;e++){const r=t[e];if(!(r instanceof Uint8Array))return!1;const a=r.length;if(7!==a)return!1;for(let t=0;t<a;t++){const a=r[t];if(0!==a&&1!==a&&2!==a)return!1;if(2===n[e][t]!=(2===a))return!1}}return!0},copyPuzzle:t=>{const e=[];for(let n=0;n<7;n++)e[n]=new Uint8Array(t[n]);return Object.seal(e),e},codeToPuzzle:(t,n=16)=>{const r=2===n?t:l(t,n,2),a=e();let o=0;for(let t=0;t<7;t++){const e=a[t];for(let t=0;t<7;t++)2!==e[t]&&(e[t]=r[o],o++)}return a},puzzleToCode:(t,e=16)=>{let n="";for(let e=0;e<7;e++){const r=t[e];for(let t=0;t<7;t++){const e=r[t];2!==e&&(n+=e)}}return 2===e?n:l(n,2,e)},convertCodeBase:l,defaultCodeBase:16,transform:a,isometryCount:r,codeImages:t=>{const e=new Set;e.add(t);for(let n=0;n<r;n++)e.add(a(t,n));return Array.from(e)},countBalls:t=>{let e=0;for(let n=0;n<7;n++)for(let r=0;r<7;r++)1===t[n][r]&&e++;return e},codeSampleRange:y,sampleCode:t=>{let e="";for(let n=0;n<u;n++)e+=t.charAt(d[n]);return parseInt(e,2)},validateMoveStruct:t=>t&&t.from&&"number"==typeof t.from.x&&"number"==typeof t.from.y&&t.to&&"number"==typeof t.to.x&&"number"==typeof t.from.y}}},e={};function n(r){var a=e[r];if(void 0!==a)return a.exports;var o=e[r]={exports:{}};return t[r](o,o.exports,n),o.exports}(()=>{const t=n(273),{useState:e,createRef:r}=React,a={disappearingAct1:[new Uint8Array([2,2,0,0,0,2,2]),new Uint8Array([2,2,0,1,0,2,2]),new Uint8Array([0,0,1,1,1,0,0]),new Uint8Array([0,0,0,1,0,0,0]),new Uint8Array([0,0,0,1,0,0,0]),new Uint8Array([2,2,0,0,0,2,2]),new Uint8Array([2,2,0,0,0,2,2])],disappearingAct2:[new Uint8Array([2,2,0,0,0,2,2]),new Uint8Array([2,2,0,1,0,2,2]),new Uint8Array([0,0,0,1,0,0,0]),new Uint8Array([0,1,1,1,1,1,0]),new Uint8Array([0,0,0,1,0,0,0]),new Uint8Array([2,2,0,1,0,2,2]),new Uint8Array([2,2,0,0,0,2,2])],disappearingAct3:[new Uint8Array([2,2,0,0,0,2,2]),new Uint8Array([2,2,0,1,0,2,2]),new Uint8Array([0,0,1,1,1,0,0]),new Uint8Array([0,1,1,1,1,1,0]),new Uint8Array([1,1,1,1,1,1,1]),new Uint8Array([2,2,0,0,0,2,2]),new Uint8Array([2,2,0,0,0,2,2])],spaceInvader:[new Uint8Array([2,2,0,0,0,2,2]),new Uint8Array([2,2,0,1,0,2,2]),new Uint8Array([0,0,1,1,1,0,0]),new Uint8Array([0,1,0,1,0,1,0]),new Uint8Array([1,1,0,1,0,1,1]),new Uint8Array([2,2,1,0,1,2,2]),new Uint8Array([2,2,0,0,0,2,2])],puroMask:[new Uint8Array([2,2,0,0,0,2,2]),new Uint8Array([2,2,0,1,0,2,2]),new Uint8Array([0,0,1,1,1,0,0]),new Uint8Array([0,1,0,1,0,1,0]),new Uint8Array([0,0,1,1,1,0,0]),new Uint8Array([2,2,1,0,1,2,2]),new Uint8Array([2,2,0,0,0,2,2])],disappearingAct4:[new Uint8Array([2,2,0,0,0,2,2]),new Uint8Array([2,2,0,0,0,2,2]),new Uint8Array([0,0,0,0,0,0,0]),new Uint8Array([0,0,1,0,1,0,0]),new Uint8Array([0,0,1,1,1,0,0]),new Uint8Array([2,2,1,1,1,2,2]),new Uint8Array([2,2,1,1,1,2,2])],generated:[new Uint8Array([2,2,0,0,0,2,2]),new Uint8Array([2,2,0,1,0,2,2]),new Uint8Array([0,0,1,1,0,0,0]),new Uint8Array([1,1,1,1,0,0,0]),new Uint8Array([1,1,0,0,0,0,0]),new Uint8Array([2,2,0,0,0,2,2]),new Uint8Array([2,2,0,0,0,2,2])],generated2:[new Uint8Array([2,2,0,0,1,2,2]),new Uint8Array([2,2,0,0,0,2,2]),new Uint8Array([0,1,1,0,1,1,0]),new Uint8Array([0,0,1,1,1,1,0]),new Uint8Array([1,1,1,0,0,0,0]),new Uint8Array([2,2,0,0,0,2,2]),new Uint8Array([2,2,0,0,0,2,2])],baseGame:[new Uint8Array([2,2,1,1,1,2,2]),new Uint8Array([2,2,1,1,1,2,2]),new Uint8Array([1,1,1,1,1,1,1]),new Uint8Array([1,1,1,0,1,1,1]),new Uint8Array([1,1,1,1,1,1,1]),new Uint8Array([2,2,1,1,1,2,2]),new Uint8Array([2,2,1,1,1,2,2])]},o=n=>{const[o,i]=e(),[s,l]=e(!1),[c,d]=e(!1),[u,y]=e(!1),h=r();return React.createElement("div",{className:"wrapper"},React.createElement("h1",null,"Disappearing Act 3"),React.createElement("h2",null,"Created by: Rory"),React.createElement(t,{ref:h,disabled:c,basis:a[n.puzzleName],onMove:()=>{i(""),l(!1),y(!1)}}),React.createElement("div",{className:"buttonContainer"},React.createElement("button",{id:"hintButton",type:"button",className:"btn btn-warning btn-lg",disabled:u||c,onClick:()=>{(async t=>{const e=t.code();if(c)return null;d(!0);const n=await fetch(`/hint?code=${e}`),{hint:r,unsolvable:a,alreadySolved:o,message:s}=await n.json();d(!1),200!==n.status?i(s):a?(l(!0),y(!0)):o?i("This puzzle has already been solved!"):r?(t.displayHint(r),y(!0)):i("Unexpected server response.")})(h.current)}},c?React.createElement("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}):React.createElement("i",{className:u?"fa-solid fa-arrow-"+(s?"right":"up"):"fa-regular fa-lightbulb"})," Hint"),React.createElement("button",{id:"undoButton",type:"button",className:"btn btn-secondary btn-lg "+(s?"undoButtonHighlighted":""),disabled:c,onClick:()=>{h.current.undo()}},React.createElement("i",{className:"fa-solid fa-arrow-rotate-left"})," Undo")),React.createElement("h3",null,o))};window.onload=()=>{ReactDOM.createRoot(document.getElementById("app")).render(React.createElement(o,{puzzleName:"disappearingAct3"}))}})()})();