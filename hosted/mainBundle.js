(()=>{var e={303:(e,t,r)=>{const{emptyBoard:n,width:a,height:o,validMoveDeltas:i,validMoveDeltaCount:s,isCode:l,isPuzzle:c,codeToPuzzle:d,puzzleToCode:u,defaultCodeBase:y}=r(175);e.exports=class{constructor(e){e?c(e)?this.puzzle=e:l(e)?this.puzzle=d(e):l(e,2)?this.puzzle=d(e,2):this.puzzle=n():this.puzzle=n(),this.moveHistory=[]}validateMove(e,t){if(!(e&&e.from&&"number"==typeof e.from.x&&"number"==typeof e.from.y&&e.to&&"number"==typeof e.to.x&&"number"==typeof e.from.y))return null;const r=e.from.x,n=e.from.y,l=e.to.x,c=e.to.y,d=l-r,u=c-n;let y=null;for(let e=0;e<s;e++){const t=i[e];t.x===d&&t.y===u&&(y=t)}if(!y)return null;const h=y.middle,f=r+h.x,m=n+h.y;if(r<0||r>=a)return null;if(n<0||n>=o)return null;if(l<0||l>=a)return null;if(c<0||c>=o)return null;const p=t?0:1,w=t?0:1,A=t?1:0;return this.puzzle[n][r]!==p||this.puzzle[m][f]!==w||this.puzzle[c][l]!==A?null:{matchingDelta:y,moveMid:{x:f,y:m}}}allValidMoves(e){const t=[];for(let r=0;r<o;r++)for(let n=0;n<a;n++)if(1===this.puzzle[r][n])for(let a=0;a<s;a++){const o=i[a],s=e?{from:{x:n-o.x,y:r-o.y},to:{x:n,y:r}}:{from:{x:n,y:r},to:{x:n+o.x,y:r+o.y}};this.validateMove(s,e)&&t.push(s)}return t}makeMove(e,t,r){const n=this.validateMove(e,t);if(!n)return!1;const{moveMid:a}=n,o=e.from,i=e.to,s=t?1:0,l=t?1:0,c=t?0:1;return this.puzzle[o.y][o.x]=s,this.puzzle[a.y][a.x]=l,this.puzzle[i.y][i.x]=c,r||this.moveHistory.push(e),!0}undo(e){this.makeMove(this.moveHistory.pop(),!e,!0)}countBalls(){let e=0;for(let t=0;t<o;t++)for(let r=0;r<a;r++)1===this.puzzle[t][r]&&e++;return e}puzzleToString(){return this.puzzle.map((e=>Array.from(e).map((e=>[".","O"," "][e])).join(" "))).join("\n")}code(e=y){return u(this.puzzle,e)}}},273:(e,t,r)=>{const{Component:n,createRef:a}=React,{distanceNoSqrt:o}=r(718),i=r(303),{emptyBoard:s,width:l,height:c,defaultCodeBase:d}=r(175);e.exports=class extends n{constructor(e){super(e),this.state={disabled:!1,holdingBall:!1},this.canvasRef=a(),this.canvasOuterRef=a(),this.game=new i(e.basis),this.code=(e=d)=>this.game.code(e),this.undo=e=>{this.game.undo(e),this.props.onMove()}}static getDerivedStateFromProps(e,t){return e.disabled!==t.disabled?{disabled:e.disabled,holdingBall:!e.disabled&&t.holdingBall}:null}componentDidMount(){const e=this.canvasRef.current,t=e.width,r=e.height,n=this.canvasOuterRef.current,a=e.getContext("2d"),i=s(),d=400/l,u=400/c,y=[];for(let e=0;e<c;e++){const t=[],r=u*(e+.5)+100;for(let n=0;n<l;n++)2!==i[e][n]&&(t[n]={x:d*(n+.5)+100,y:r});y[e]=t}let h=t/2,f=r/2;const m=t=>{if(!t)return;let r,a;const o=t.type.slice(0,5);"touch"===o?(r=t.touches[0].pageX,a=t.touches[0].pageY):"mouse"===o&&(r=t.pageX,a=t.pageY),h=(r-n.offsetLeft)*(e.width/n.offsetWidth),f=(a-n.offsetTop)*(e.height/n.offsetHeight)};let p=Math.floor(l/2),w=Math.floor(c/2);const A=e=>{m(e),p=Math.floor((h-100)/d),w=Math.floor((f-100)/u)};let U=0,g=0;const z=e=>{if(!this.state.disabled&&(A(e),1===this.game.puzzle[w][p])){const e=y[w][p];e&&o(h,f,e.x,e.y)<400&&(this.setState({holdingBall:!0}),U=p,g=w)}},v=e=>{if(this.state.disabled||!this.state.holdingBall)return;this.setState({holdingBall:!1}),A(e);const t={from:{x:U,y:g},to:{x:p,y:w}};this.game.makeMove(t)&&this.props.onMove()};n.onmousedown=z,n.onmousemove=m,n.onmouseup=v,n.onmouseout=v,n.ontouchstart=z,n.ontouchmove=m,n.ontouchend=v,n.ontouchcancel=v,a.lineWidth=3,a.strokeStyle="black",a.fillStyle="black";const b=()=>{requestAnimationFrame(b),a.clearRect(0,0,t,r);for(let e=0;e<c;e++)for(let t=0;t<l;t++){const r=y[e][t];r&&(a.beginPath(),a.rect(d*t+100,u*e+100,d,u),a.closePath(),a.stroke(),1!==this.game.puzzle[e][t]||this.state.holdingBall&&t===U&&e===g||(a.beginPath(),a.arc(r.x,r.y,20,0,2*Math.PI),a.closePath(),a.fill()))}this.state.holdingBall&&(a.fillStyle="red",a.beginPath(),a.arc(h,f,20,0,2*Math.PI),a.closePath(),a.fill(),a.fillStyle="black"),a.beginPath()};b()}render(){return React.createElement("div",{ref:this.canvasOuterRef,className:"gameBoardCanvasOuter"},React.createElement("div",{className:"ratio1x1"},React.createElement("div",{className:"ratioContainer"},React.createElement("canvas",{ref:this.canvasRef,className:"gameBoardCanvas",width:"600",height:"600"}))))}}},718:e=>{e.exports={distanceNoSqrt:(e,t,r,n)=>{const a=r-e,o=n-t;return a*a+o*o},byteToBits:e=>e.toString(2).padStart(8,"0"),byteFromBitRemainder:e=>parseInt(e.padEnd(8,"0"),2),formatTime:e=>{const t=Math.floor(e/36e5),r=Math.floor(e/6e4)%60,n=Math.floor(e/1e3)%60,a=e%1e3;return`${t.toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}:${n.toString().padStart(2,"0")}.${a.toString().padStart(3,"0")}`}}},175:e=>{const t=()=>{const e=[new Uint8Array([2,2,0,0,0,2,2]),new Uint8Array([2,2,0,0,0,2,2]),new Uint8Array([0,0,0,0,0,0,0]),new Uint8Array([0,0,0,0,0,0,0]),new Uint8Array([0,0,0,0,0,0,0]),new Uint8Array([2,2,0,0,0,2,2]),new Uint8Array([2,2,0,0,0,2,2])];return Object.seal(e),e},r=[[2,1,0,5,4,3,12,11,10,9,8,7,6,19,18,17,16,15,14,13,26,25,24,23,22,21,20,29,28,27,32,31,30],[30,31,32,27,28,29,20,21,22,23,24,25,26,13,14,15,16,17,18,19,6,7,8,9,10,11,12,3,4,5,0,1,2],[32,31,30,29,28,27,26,25,24,23,22,21,20,19,18,17,16,15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,0],[6,13,20,7,14,21,0,3,8,15,22,27,30,1,4,9,16,23,28,31,2,5,10,17,24,29,32,11,18,25,12,19,26],[26,19,12,25,18,11,32,29,24,17,10,5,2,31,28,23,16,9,4,1,30,27,22,15,8,3,0,21,14,7,20,13,6],[12,19,26,11,18,25,2,5,10,17,24,29,32,1,4,9,16,23,28,31,0,3,8,15,22,27,30,7,14,21,6,13,20],[20,13,6,21,14,7,30,27,22,15,8,3,0,31,28,23,16,9,4,1,32,29,24,17,10,5,2,25,18,11,26,19,12]],n=(e,t)=>{const n=r[t];let a="";for(let t=0;t<33;t++)a+=e.charAt(n[t]);return a},a=parseInt("1".repeat(33),2),o=[];for(let e=2;e<=36;e++)o[e]=(i=e,a.toString(i).length);var i;const s=(e,t,r)=>parseInt(e,t).toString(r).padStart(o[r],"0"),l=[],c="0123456789abcdefghijklmnopqrstuvwxyz";for(let e=2;e<=36;e++)l[e]=new RegExp(`^[${c.slice(0,e)}]{${o[e]}}$`);e.exports={emptyBoard:t,width:7,height:7,slotCount:33,validMoveDeltas:[{name:"right",x:2,y:0,middle:{x:1,y:0}},{name:"up",x:0,y:-2,middle:{x:0,y:-1}},{name:"left",x:-2,y:0,middle:{x:-1,y:0}},{name:"down",x:0,y:2,middle:{x:0,y:1}}],validMoveDeltaCount:4,hexaTriDigitStr:c,midCharIndex:2,isCode:(e,t=16)=>l[t].test(e),isPuzzle:e=>{if(!e)return!1;const r=t();if(!Array.isArray(e))return!1;const n=e.length;if(7!==n)return!1;for(let t=0;t<n;t++){const n=e[t];if(!(n instanceof Uint8Array))return!1;const a=n.length;if(7!==a)return!1;for(let e=0;e<a;e++){const a=n[e];if(0!==a&&1!==a&&2!==a)return!1;if(2===r[t][e]!=(2===a))return!1}}return!0},copyPuzzle:e=>{const t=[];for(let r=0;r<7;r++)t[r]=new Uint8Array(e[r]);return Object.seal(t),t},codeToPuzzle:(e,r=16)=>{const n=2===r?e:s(e,r,2),a=t();let o=0;for(let e=0;e<7;e++){const t=a[e];for(let e=0;e<7;e++)2!==t[e]&&(t[e]=n[o],o++)}return a},puzzleToCode:(e,t=16)=>{let r="";for(let t=0;t<7;t++){const n=e[t];for(let e=0;e<7;e++){const t=n[e];2!==t&&(r+=t)}}return 2===t?r:s(r,2,t)},convertCodeBase:s,defaultCodeBase:16,transform:n,isometryCount:7,codeImages:e=>{const t=new Set;t.add(e);for(let r=0;r<7;r++)t.add(n(e,r));return Array.from(t)}}}},t={};function r(n){var a=t[n];if(void 0!==a)return a.exports;var o=t[n]={exports:{}};return e[n](o,o.exports,r),o.exports}(()=>{const e=r(273),{useState:t,createRef:n}=React,a={disappearingAct1:[new Uint8Array([2,2,0,0,0,2,2]),new Uint8Array([2,2,0,1,0,2,2]),new Uint8Array([0,0,1,1,1,0,0]),new Uint8Array([0,0,0,1,0,0,0]),new Uint8Array([0,0,0,1,0,0,0]),new Uint8Array([2,2,0,0,0,2,2]),new Uint8Array([2,2,0,0,0,2,2])],disappearingAct2:[new Uint8Array([2,2,0,0,0,2,2]),new Uint8Array([2,2,0,1,0,2,2]),new Uint8Array([0,0,0,1,0,0,0]),new Uint8Array([0,1,1,1,1,1,0]),new Uint8Array([0,0,0,1,0,0,0]),new Uint8Array([2,2,0,1,0,2,2]),new Uint8Array([2,2,0,0,0,2,2])],disappearingAct3:[new Uint8Array([2,2,0,0,0,2,2]),new Uint8Array([2,2,0,1,0,2,2]),new Uint8Array([0,0,1,1,1,0,0]),new Uint8Array([0,1,1,1,1,1,0]),new Uint8Array([1,1,1,1,1,1,1]),new Uint8Array([2,2,0,0,0,2,2]),new Uint8Array([2,2,0,0,0,2,2])],spaceInvader:[new Uint8Array([2,2,0,0,0,2,2]),new Uint8Array([2,2,0,1,0,2,2]),new Uint8Array([0,0,1,1,1,0,0]),new Uint8Array([0,1,0,1,0,1,0]),new Uint8Array([1,1,0,1,0,1,1]),new Uint8Array([2,2,1,0,1,2,2]),new Uint8Array([2,2,0,0,0,2,2])],puroMask:[new Uint8Array([2,2,0,0,0,2,2]),new Uint8Array([2,2,0,1,0,2,2]),new Uint8Array([0,0,1,1,1,0,0]),new Uint8Array([0,1,0,1,0,1,0]),new Uint8Array([0,0,1,1,1,0,0]),new Uint8Array([2,2,1,0,1,2,2]),new Uint8Array([2,2,0,0,0,2,2])],disappearingAct4:[new Uint8Array([2,2,0,0,0,2,2]),new Uint8Array([2,2,0,0,0,2,2]),new Uint8Array([0,0,0,0,0,0,0]),new Uint8Array([0,0,1,0,1,0,0]),new Uint8Array([0,0,1,1,1,0,0]),new Uint8Array([2,2,1,1,1,2,2]),new Uint8Array([2,2,1,1,1,2,2])],generated:[new Uint8Array([2,2,0,0,0,2,2]),new Uint8Array([2,2,0,1,0,2,2]),new Uint8Array([0,0,1,1,0,0,0]),new Uint8Array([1,1,1,1,0,0,0]),new Uint8Array([1,1,0,0,0,0,0]),new Uint8Array([2,2,0,0,0,2,2]),new Uint8Array([2,2,0,0,0,2,2])],generated2:[new Uint8Array([2,2,0,0,1,2,2]),new Uint8Array([2,2,0,0,0,2,2]),new Uint8Array([0,1,1,0,1,1,0]),new Uint8Array([0,0,1,1,1,1,0]),new Uint8Array([1,1,1,0,0,0,0]),new Uint8Array([2,2,0,0,0,2,2]),new Uint8Array([2,2,0,0,0,2,2])],baseGame:[new Uint8Array([2,2,1,1,1,2,2]),new Uint8Array([2,2,1,1,1,2,2]),new Uint8Array([1,1,1,1,1,1,1]),new Uint8Array([1,1,1,0,1,1,1]),new Uint8Array([1,1,1,1,1,1,1]),new Uint8Array([2,2,1,1,1,2,2]),new Uint8Array([2,2,1,1,1,2,2])]},o=r=>{const[o,i]=t(),[s,l]=t(!1),c=n();return React.createElement("div",{className:"wrapper"},React.createElement("h1",null,"Disappearing Act 2"),React.createElement("h2",null,"Created by: Hopper"),React.createElement(e,{ref:c,disabled:s,basis:a[r.puzzleName],onMove:()=>{i("")}}),React.createElement("div",{className:"buttonContainer"},React.createElement("button",{id:"hintButton",type:"button",className:"btn btn-warning btn-lg",disabled:s,onClick:()=>{(async e=>{if(s)return null;l(!0),i("Awaiting hint...");const t=await fetch(`/hint?code=${e}`),{hint:r,unsolvable:n,alreadySolved:a,message:o}=await t.json();l(!1),200!==t.status?i(o):i(n?"Not solvable from this point! Please undo.":a?"This puzzle has already been solved!":r?React.createElement(React.Fragment,null,"(",r.from.x+1,", ",r.from.y+1,")"," ",React.createElement("i",{className:"fa fa-solid fa-arrow-right"})," ","(",r.to.x+1,", ",r.to.y+1,")"):"Unexpected server response.")})(c.current.code())}},React.createElement("i",{className:"fa-regular fa-lightbulb"})," Hint"),React.createElement("button",{id:"undoButton",type:"button",className:"btn btn-secondary btn-lg",disabled:s,onClick:()=>{c.current.undo()}},React.createElement("i",{className:"fa-solid fa-arrow-rotate-left"})," Undo")),React.createElement("h3",null,o))};window.onload=()=>{ReactDOM.createRoot(document.getElementById("app")).render(React.createElement(o,{puzzleName:"disappearingAct2"}))}})()})();