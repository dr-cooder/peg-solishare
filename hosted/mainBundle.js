(()=>{var e={303:(e,t,n)=>{const{emptyBoard:r,width:a,height:i,validMoveDeltas:o,validMoveDeltaCount:s,isCode:l,isPuzzle:c,codeToPuzzle:u,puzzleToCode:d,defaultCodeBase:y}=n(175);e.exports=class{constructor(e){e?c(e)?this.puzzle=e:l(e)?this.puzzle=u(e):l(e,2)?this.puzzle=u(e,2):this.puzzle=r():this.puzzle=r(),this.moveHistory=[]}validateMove(e,t){if(!(e&&e.from&&"number"==typeof e.from.x&&"number"==typeof e.from.y&&e.to&&"number"==typeof e.to.x&&"number"==typeof e.from.y))return null;const n=e.from.x,r=e.from.y,l=e.to.x,c=e.to.y,u=l-n,d=c-r;let y=null;for(let e=0;e<s;e++){const t=o[e];t.x===u&&t.y===d&&(y=t)}if(!y)return null;const h=y.middle,f=n+h.x,m=r+h.y;if(n<0||n>=a)return null;if(r<0||r>=i)return null;if(l<0||l>=a)return null;if(c<0||c>=i)return null;const p=t?0:1,w=t?0:1,A=t?1:0;return this.puzzle[r][n]!==p||this.puzzle[m][f]!==w||this.puzzle[c][l]!==A?null:{matchingDelta:y,moveMid:{x:f,y:m}}}allValidMoves(e){const t=[];for(let n=0;n<i;n++)for(let r=0;r<a;r++)if(1===this.puzzle[n][r])for(let a=0;a<s;a++){const i=o[a],s=e?{from:{x:r-i.x,y:n-i.y},to:{x:r,y:n}}:{from:{x:r,y:n},to:{x:r+i.x,y:n+i.y}};this.validateMove(s,e)&&t.push(s)}return t}makeMove(e,t,n){const r=this.validateMove(e,t);if(!r)return!1;const{moveMid:a}=r,i=e.from,o=e.to,s=t?1:0,l=t?1:0,c=t?0:1;return this.puzzle[i.y][i.x]=s,this.puzzle[a.y][a.x]=l,this.puzzle[o.y][o.x]=c,n||this.moveHistory.push(e),!0}undo(e){this.makeMove(this.moveHistory.pop(),!e,!0)}countBalls(){let e=0;for(let t=0;t<i;t++)for(let n=0;n<a;n++)1===this.puzzle[t][n]&&e++;return e}puzzleToString(){return this.puzzle.map((e=>Array.from(e).map((e=>[".","O"," "][e])).join(" "))).join("\n")}code(e=y){return d(this.puzzle,e)}}},273:(e,t,n)=>{const{Component:r,createRef:a}=React,{distanceNoSqrt:i}=n(718),o=n(303),{emptyBoard:s,width:l,height:c,defaultCodeBase:u}=n(175);e.exports=class extends r{constructor(e){super(e),this.state={disabled:!1,holdingBall:!1},this.canvasRef=a(),this.canvasOuterRef=a(),this.game=new o(e.basis),this.code=(e=u)=>this.game.code(e),this.undo=e=>{this.game.undo(e),this.props.onMove()}}static getDerivedStateFromProps(e,t){return e.disabled!==t.disabled?{disabled:e.disabled,holdingBall:!e.disabled&&t.holdingBall}:null}componentDidMount(){const e=this.canvasRef.current,t=e.width,n=e.height,r=this.canvasOuterRef.current,a=e.getContext("2d"),o=s(),u=400/l,d=400/c,y=[];for(let e=0;e<c;e++){const t=[],n=d*(e+.5)+100;for(let r=0;r<l;r++)2!==o[e][r]&&(t[r]={x:u*(r+.5)+100,y:n});y[e]=t}let h=t/2,f=n/2;const m=t=>{if(!t)return;let n,a;const i=t.type.slice(0,5);"touch"===i?(n=t.touches[0].pageX,a=t.touches[0].pageY):"mouse"===i&&(n=t.pageX,a=t.pageY),h=(n-r.offsetLeft)*(e.width/r.offsetWidth),f=(a-r.offsetTop)*(e.height/r.offsetHeight)};let p=Math.floor(l/2),w=Math.floor(c/2);const A=e=>{m(e),p=Math.floor((h-100)/u),w=Math.floor((f-100)/d)};let U=0,g=0;const z=e=>{if(!this.state.disabled&&(A(e),1===this.game.puzzle[w][p])){const e=y[w][p];e&&i(h,f,e.x,e.y)<400&&(this.setState({holdingBall:!0}),U=p,g=w)}},v=e=>{if(this.state.disabled||!this.state.holdingBall)return;this.setState({holdingBall:!1}),A(e);const t={from:{x:U,y:g},to:{x:p,y:w}};this.game.makeMove(t)&&this.props.onMove()};r.onmousedown=z,r.onmousemove=m,r.onmouseup=v,r.onmouseout=v,r.ontouchstart=z,r.ontouchmove=m,r.ontouchend=v,r.ontouchcancel=v,a.lineWidth=3,a.strokeStyle="black",a.fillStyle="black";const b=()=>{requestAnimationFrame(b),a.clearRect(0,0,t,n);for(let e=0;e<c;e++)for(let t=0;t<l;t++){const n=y[e][t];n&&(a.beginPath(),a.rect(u*t+100,d*e+100,u,d),a.closePath(),a.stroke(),1!==this.game.puzzle[e][t]||this.state.holdingBall&&t===U&&e===g||(a.beginPath(),a.arc(n.x,n.y,20,0,2*Math.PI),a.closePath(),a.fill()))}this.state.holdingBall&&(a.fillStyle="red",a.beginPath(),a.arc(h,f,20,0,2*Math.PI),a.closePath(),a.fill(),a.fillStyle="black"),a.beginPath()};b()}render(){return React.createElement("div",{ref:this.canvasOuterRef,className:"gameBoardCanvasOuter"},React.createElement("div",{className:"ratio1x1"},React.createElement("div",{className:"ratioContainer"},React.createElement("canvas",{ref:this.canvasRef,className:"gameBoardCanvas",width:"600",height:"600"}))))}}},718:e=>{e.exports={distanceNoSqrt:(e,t,n,r)=>{const a=n-e,i=r-t;return a*a+i*i},byteToBits:e=>e.toString(2).padStart(8,"0"),byteFromBitRemainder:e=>parseInt(e.padEnd(8,"0"),2)}},175:e=>{const t=()=>{const e=[new Uint8Array([2,2,0,0,0,2,2]),new Uint8Array([2,2,0,0,0,2,2]),new Uint8Array([0,0,0,0,0,0,0]),new Uint8Array([0,0,0,0,0,0,0]),new Uint8Array([0,0,0,0,0,0,0]),new Uint8Array([2,2,0,0,0,2,2]),new Uint8Array([2,2,0,0,0,2,2])];return Object.seal(e),e},n=parseInt("1".repeat(33),2),r=[];for(let e=2;e<=36;e++)r[e]=(a=e,n.toString(a).length);var a;const i=(e,t,n)=>parseInt(e,t).toString(n).padStart(r[n],"0"),o=[];for(let e=2;e<=36;e++)o[e]=new RegExp(`^[${"0123456789abcdefghijklmnopqrstuvwxyz".slice(0,e)}]{${r[e]}}$`);e.exports={emptyBoard:t,width:7,height:7,slotCount:33,validMoveDeltas:[{name:"right",x:2,y:0,middle:{x:1,y:0}},{name:"up",x:0,y:-2,middle:{x:0,y:-1}},{name:"left",x:-2,y:0,middle:{x:-1,y:0}},{name:"down",x:0,y:2,middle:{x:0,y:1}}],validMoveDeltaCount:4,isCode:(e,t=16)=>o[t].test(e),isPuzzle:e=>{if(!e)return!1;const n=t();if(!Array.isArray(e))return!1;const r=e.length;if(7!==r)return!1;for(let t=0;t<r;t++){const r=e[t];if(!(r instanceof Uint8Array))return!1;const a=r.length;if(7!==a)return!1;for(let e=0;e<a;e++){const a=r[e];if(0!==a&&1!==a&&2!==a)return!1;if(2===n[t][e]!=(2===a))return!1}}return!0},copyPuzzle:e=>{const t=[];for(let n=0;n<7;n++)t[n]=new Uint8Array(e[n]);return Object.seal(t),t},codeToPuzzle:(e,n=16)=>{const r=2===n?e:i(e,n,2),a=t();let o=0;for(let e=0;e<7;e++){const t=a[e];for(let e=0;e<7;e++)2!==t[e]&&(t[e]=r[o],o++)}return a},puzzleToCode:(e,t=16)=>{let n="";for(let t=0;t<7;t++){const r=e[t];for(let e=0;e<7;e++){const t=r[e];2!==t&&(n+=t)}}return 2===t?n:i(n,2,t)},convertCodeBase:i,defaultCodeBase:16}}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}(()=>{const e=n(273),{useState:t,createRef:r}=React,a={disappearingAct1:[new Uint8Array([2,2,0,0,0,2,2]),new Uint8Array([2,2,0,1,0,2,2]),new Uint8Array([0,0,1,1,1,0,0]),new Uint8Array([0,0,0,1,0,0,0]),new Uint8Array([0,0,0,1,0,0,0]),new Uint8Array([2,2,0,0,0,2,2]),new Uint8Array([2,2,0,0,0,2,2])],disappearingAct2:[new Uint8Array([2,2,0,0,0,2,2]),new Uint8Array([2,2,0,1,0,2,2]),new Uint8Array([0,0,0,1,0,0,0]),new Uint8Array([0,1,1,1,1,1,0]),new Uint8Array([0,0,0,1,0,0,0]),new Uint8Array([2,2,0,1,0,2,2]),new Uint8Array([2,2,0,0,0,2,2])],disappearingAct3:[new Uint8Array([2,2,0,0,0,2,2]),new Uint8Array([2,2,0,1,0,2,2]),new Uint8Array([0,0,1,1,1,0,0]),new Uint8Array([0,1,1,1,1,1,0]),new Uint8Array([1,1,1,1,1,1,1]),new Uint8Array([2,2,0,0,0,2,2]),new Uint8Array([2,2,0,0,0,2,2])],spaceInvader:[new Uint8Array([2,2,0,0,0,2,2]),new Uint8Array([2,2,0,1,0,2,2]),new Uint8Array([0,0,1,1,1,0,0]),new Uint8Array([0,1,0,1,0,1,0]),new Uint8Array([1,1,0,1,0,1,1]),new Uint8Array([2,2,1,0,1,2,2]),new Uint8Array([2,2,0,0,0,2,2])],puroMask:[new Uint8Array([2,2,0,0,0,2,2]),new Uint8Array([2,2,0,1,0,2,2]),new Uint8Array([0,0,1,1,1,0,0]),new Uint8Array([0,1,0,1,0,1,0]),new Uint8Array([0,0,1,1,1,0,0]),new Uint8Array([2,2,1,0,1,2,2]),new Uint8Array([2,2,0,0,0,2,2])],disappearingAct4:[new Uint8Array([2,2,0,0,0,2,2]),new Uint8Array([2,2,0,0,0,2,2]),new Uint8Array([0,0,0,0,0,0,0]),new Uint8Array([0,0,1,0,1,0,0]),new Uint8Array([0,0,1,1,1,0,0]),new Uint8Array([2,2,1,1,1,2,2]),new Uint8Array([2,2,1,1,1,2,2])],generated:[new Uint8Array([2,2,0,0,0,2,2]),new Uint8Array([2,2,0,1,0,2,2]),new Uint8Array([0,0,1,1,0,0,0]),new Uint8Array([1,1,1,1,0,0,0]),new Uint8Array([1,1,0,0,0,0,0]),new Uint8Array([2,2,0,0,0,2,2]),new Uint8Array([2,2,0,0,0,2,2])],generated2:[new Uint8Array([2,2,0,0,1,2,2]),new Uint8Array([2,2,0,0,0,2,2]),new Uint8Array([0,1,1,0,1,1,0]),new Uint8Array([0,0,1,1,1,1,0]),new Uint8Array([1,1,1,0,0,0,0]),new Uint8Array([2,2,0,0,0,2,2]),new Uint8Array([2,2,0,0,0,2,2])],baseGame:[new Uint8Array([2,2,1,1,1,2,2]),new Uint8Array([2,2,1,1,1,2,2]),new Uint8Array([1,1,1,1,1,1,1]),new Uint8Array([1,1,1,0,1,1,1]),new Uint8Array([1,1,1,1,1,1,1]),new Uint8Array([2,2,1,1,1,2,2]),new Uint8Array([2,2,1,1,1,2,2])]},i=n=>{const[i,o]=t(),[s,l]=t(!1),c=r();return React.createElement("div",{className:"wrapper"},React.createElement("h1",null,"Disappearing Act 1"),React.createElement("h2",null,"Created by: Niles"),React.createElement(e,{ref:c,disabled:s,basis:a[n.puzzleName],onMove:()=>{o("")}}),React.createElement("div",{className:"buttonContainer"},React.createElement("button",{id:"hintButton",type:"button",className:"btn btn-warning btn-lg",disabled:s,onClick:()=>{(async e=>{if(s)return null;l(!0),o("Awaiting hint...");const t=await fetch(`/hint?code=${e}`),{hint:n,unsolvable:r,alreadySolved:a,message:i}=await t.json();l(!1),200!==t.status?o(i):o(r?"Not solvable from this point! Please undo.":a?"This puzzle has already been solved!":n?React.createElement(React.Fragment,null,"(",n.from.x+1,", ",n.from.y+1,")"," ",React.createElement("i",{className:"fa fa-solid fa-arrow-right"})," ","(",n.to.x+1,", ",n.to.y+1,")"):"Unexpected server response.")})(c.current.code())}},React.createElement("i",{className:"fa-regular fa-lightbulb"})," Hint"),React.createElement("button",{id:"undoButton",type:"button",className:"btn btn-secondary btn-lg",disabled:s,onClick:()=>{c.current.undo()}},React.createElement("i",{className:"fa-solid fa-arrow-rotate-left"})," Undo")),React.createElement("h3",null,i))};window.onload=()=>{ReactDOM.createRoot(document.getElementById("app")).render(React.createElement(i,{puzzleName:"disappearingAct1"}))}})()})();