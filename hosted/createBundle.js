(()=>{var e={303:(e,t,o)=>{const{emptyBoard:n,width:a,height:r,validMoveDeltas:l,validMoveDeltaCount:s,isCode:i,isPuzzle:c,codeToPuzzle:d,puzzleToCode:u,defaultCodeBase:h,countBalls:m,validateMoveStruct:f,findMoveDelta:p}=o(175);e.exports=class{constructor(e){e?c(e)?this.puzzle=e:i(e)?this.puzzle=d(e):i(e,2)?this.puzzle=d(e,2):this.puzzle=n():this.puzzle=n(),this.moveHistory=[]}validateMove(e,t){if(!f(e))return null;const o=e.from.x,n=e.from.y,l=e.to.x,s=e.to.y,i=p(o,n,l,s);if(!i)return null;const c=i.middle,d=o+c.x,u=n+c.y;if(o<0||o>=a)return null;if(n<0||n>=r)return null;if(l<0||l>=a)return null;if(s<0||s>=r)return null;const h=t?0:1,m=t?0:1,g=t?1:0;return this.puzzle[n][o]!==h||this.puzzle[u][d]!==m||this.puzzle[s][l]!==g?null:{matchingDelta:i,moveMid:{x:d,y:u}}}allValidMoves(e){const t=[];for(let o=0;o<r;o++)for(let n=0;n<a;n++)if(1===this.puzzle[o][n])for(let a=0;a<s;a++){const r=l[a],s=e?{from:{x:n-r.x,y:o-r.y},to:{x:n,y:o}}:{from:{x:n,y:o},to:{x:n+r.x,y:o+r.y}};this.validateMove(s,e)&&t.push(s)}return t}makeMove(e,t,o){const n=this.validateMove(e,t);if(!n)return!1;const{moveMid:a}=n,r=e.from,l=e.to,s=t?1:0,i=t?1:0,c=t?0:1;return this.puzzle[r.y][r.x]=s,this.puzzle[a.y][a.x]=i,this.puzzle[l.y][l.x]=c,o||this.moveHistory.push(e),!0}toggleBall(e,t,o){const n=this.puzzle[t][e];2!==n&&(this.puzzle[t][e]=0===n?1:0,o||this.moveHistory.push({toggle:{x:e,y:t}}))}undo(e){const t=this.moveHistory.pop();if(!t)return;const{toggle:o}=t;o?this.toggleBall(o.x,o.y,!0):this.makeMove(t,!e,!0)}countBalls(){return m(this.puzzle)}puzzleToString(){return this.puzzle.map((e=>Array.from(e).map((e=>[".","O"," "][e])).join(" "))).join("\n")}code(e=h){return u(this.puzzle,e)}}},273:(e,t,o)=>{const{Component:n,createRef:a}=React,{distanceNoSqrt:r,loadImage:l}=o(718),s=o(303),{emptyBoard:i,width:c,height:d,defaultCodeBase:u,validateMoveStruct:h}=o(175);e.exports=class extends n{constructor(e){super(e),this.state={disabled:!1,holdingBall:!1},this.canvasRef=a(),this.canvasOuterRef=a(),this.game=new s(e.basis),this.code=(e=u)=>this.game.code(e),this.editMode=e.editMode,this.onMove=e.onMove||(()=>{}),this.undo=()=>{this.game.undo(this.editMode),this.hintOnDisplay=null,this.onMove()},this.hintOnDisplay=null,this.displayHint=e=>{h(e)&&(this.hintOnDisplay=e)}}static getDerivedStateFromProps(e,t){return e.disabled!==t.disabled?{disabled:e.disabled,holdingBall:!e.disabled&&t.holdingBall}:null}componentDidMount(){const e=this.canvasRef.current,t=e.width,o=e.height,n=this.canvasOuterRef.current,a=e.getContext("2d"),s=i(),u=382/c,h=382/d,m=[];for(let e=0;e<d;e++){const t=[],o=h*(e+.5)+109,n=h*e+109;for(let a=0;a<c;a++)2!==s[e][a]&&(t[a]={x:u*(a+.5)+109,y:o,left:u*a+109,top:n});m[e]=t}const f=Object.entries({board:"board.png",ball:"ball.png",ballShadow:"ball-shadow.png"}),p=f.length,g={};let y=t/2,v=o/2;const z=t=>{if(!t)return;let o,a;const r=t.type.slice(0,5);"touch"===r?(o=t.touches[0].pageX,a=t.touches[0].pageY):"mouse"===r&&(o=t.pageX,a=t.pageY),y=(o-n.offsetLeft)*(e.width/n.offsetWidth),v=(a-n.offsetTop)*(e.height/n.offsetHeight)};let x=Math.floor(c/2),b=Math.floor(d/2);const M=e=>{z(e),x=Math.floor((y-109)/u),b=Math.floor((v-109)/h)};let R=0,w=0;const S=e=>{if(this.state.disabled)return;M(e);const t=this.game.puzzle[b];if(t){const e=t[x];if(void 0!==e){const t=m[b][x];r(y,v,t.x,t.y)<400&&("toggleBalls"===this.editMode?this.game.toggleBall(x,b):1===e&&(this.setState({holdingBall:!0}),R=x,w=b))}}},B=e=>{if(this.state.disabled||!this.state.holdingBall||"toggleBalls"===this.editMode)return;this.setState({holdingBall:!1}),M(e);const t={from:{x:R,y:w},to:{x,y:b}};let o;o="solveReverse"===this.editMode?this.game.makeMove({from:t.to,to:t.from},!0):this.game.makeMove(t),o&&(this.hintOnDisplay=null,this.onMove())};n.onmousedown=S,n.onmousemove=z,n.onmouseup=B,n.onmouseout=B,n.ontouchstart=S,n.ontouchmove=z,n.ontouchend=B,n.ontouchcancel=B;const C=()=>{requestAnimationFrame(C),a.clearRect(0,0,t,o),a.drawImage(g.board,0,0,t,o),a.lineWidth=3,a.lineJoin="miter",a.strokeStyle="black",a.fillStyle="black";for(let e=0;e<d;e++)for(let t=0;t<c;t++){const o=m[e][t];o&&(1!==this.game.puzzle[e][t]||this.state.holdingBall&&t===R&&e===w||a.drawImage(g.ballShadow,o.x-26,o.y-26,52,52))}if(this.hintOnDisplay){a.lineWidth=6,a.lineJoin="round",a.strokeStyle="red",a.fillStyle="red";const e=this.hintOnDisplay.from,t=m[e.y][e.x],o=t.x,n=t.y,r=this.hintOnDisplay.to,l=m[r.y][r.x],s=l.x-o,i=l.y-n,c=o+.75*s,d=n+.75*i,u=.05*i,h=.05*s;a.beginPath(),a.moveTo(o+.25*s,n+.25*i),a.lineTo(c,d),a.lineTo(c+u,d+h),a.lineTo(o+.85*s,n+.85*i),a.lineTo(c-u,d-h),a.lineTo(c,d),a.closePath(),a.stroke(),a.fill()}this.state.holdingBall&&a.drawImage(g.ball,y-26,v-26,52,52)},E=[];for(let e=0;e<p;e++)E[e]=l(`assets/img/${f[e][1]}`);Promise.all(E).then((e=>{for(let t=0;t<p;t++)g[f[t][0]]=e[t];C()}))}render(){return React.createElement("div",{ref:this.canvasOuterRef,className:"gameBoardCanvasOuter"},React.createElement("div",{className:"ratio1x1"},React.createElement("div",{className:"ratioContainer"},React.createElement("canvas",{ref:this.canvasRef,className:"gameBoardCanvas",width:"600",height:"600"}))))}}},718:e=>{const t=e=>{const t=Math.floor(e/36e5),o=Math.floor(e/6e4)%60,n=Math.floor(e/1e3)%60,a=e%1e3;return`${t.toString().padStart(2,"0")}:${o.toString().padStart(2,"0")}:${n.toString().padStart(2,"0")}.${a.toString().padStart(3,"0")}`};e.exports={distanceNoSqrt:(e,t,o,n)=>{const a=o-e,r=n-t;return a*a+r*r},byteToBits:e=>e.toString(2).padStart(8,"0"),byteFromBitRemainder:e=>parseInt(e.padEnd(8,"0"),2),formatTime:t,progressPercent:(e,t)=>{const o=e.toString().padStart(2,"0").padStart(4," "),n=` [32m${o.slice(0,-1)}.${o.slice(-1)}%[39m`;process.stdout.cursorTo(t),process.stdout.write(n)},doneHavingStartedAt:e=>{const o=Date.now()-e;process.stdout.write(`\nDone after ${t(o)}\n`)},loadImage:e=>new Promise(((t,o)=>{const n=new Image;n.crossOrigin="Anonymous",n.src=e,n.onload=()=>{t(n)},n.onerror=e=>{o(e)}})),sendPost:async(e,t,o)=>{const n=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),a=await n.json();a.redirect&&(window.location=a.redirect),o&&o(a)}}},175:e=>{const t=()=>{const e=[new Uint8Array([2,2,0,0,0,2,2]),new Uint8Array([2,2,0,0,0,2,2]),new Uint8Array([0,0,0,0,0,0,0]),new Uint8Array([0,0,0,0,0,0,0]),new Uint8Array([0,0,0,0,0,0,0]),new Uint8Array([2,2,0,0,0,2,2]),new Uint8Array([2,2,0,0,0,2,2])];return Object.seal(e),e},o=[{name:"right",x:2,y:0,middle:{x:1,y:0}},{name:"up",x:0,y:-2,middle:{x:0,y:-1}},{name:"left",x:-2,y:0,middle:{x:-1,y:0}},{name:"down",x:0,y:2,middle:{x:0,y:1}}],n=[[2,1,0,5,4,3,12,11,10,9,8,7,6,19,18,17,16,15,14,13,26,25,24,23,22,21,20,29,28,27,32,31,30],[30,31,32,27,28,29,20,21,22,23,24,25,26,13,14,15,16,17,18,19,6,7,8,9,10,11,12,3,4,5,0,1,2],[32,31,30,29,28,27,26,25,24,23,22,21,20,19,18,17,16,15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,0],[6,13,20,7,14,21,0,3,8,15,22,27,30,1,4,9,16,23,28,31,2,5,10,17,24,29,32,11,18,25,12,19,26],[26,19,12,25,18,11,32,29,24,17,10,5,2,31,28,23,16,9,4,1,30,27,22,15,8,3,0,21,14,7,20,13,6],[12,19,26,11,18,25,2,5,10,17,24,29,32,1,4,9,16,23,28,31,0,3,8,15,22,27,30,7,14,21,6,13,20],[20,13,6,21,14,7,30,27,22,15,8,3,0,31,28,23,16,9,4,1,32,29,24,17,10,5,2,25,18,11,26,19,12]],a=n.length,r=(e,t)=>{const o=n[t];let a="";for(let t=0;t<33;t++)a+=e.charAt(o[t]);return a},l=parseInt("1".repeat(33),2),s=[];for(let e=2;e<=36;e++)s[e]=(i=e,l.toString(i).length);var i;const c=(e,t,o)=>parseInt(e,t).toString(o).padStart(s[o],"0"),d=[];for(let e=2;e<=36;e++)d[e]=new RegExp(`^[${"0123456789abcdefghijklmnopqrstuvwxyz".slice(0,e)}]{${s[e]}}$`);const u=[4,8,10,14,18,22,24,28],h=u.length,m=2**h;e.exports={emptyBoard:t,width:7,height:7,slotCount:33,validMoveDeltas:o,validMoveDeltaCount:4,findMoveDelta:(e,t,n,a)=>{const r=n-e,l=a-t;let s=null;for(let e=0;e<4;e++){const t=o[e];t.x===r&&t.y===l&&(s=t)}return s},codeRegExps:d,isCode:(e,t=36)=>d[t].test(e),isPuzzle:e=>{if(!e)return!1;const o=t();if(!Array.isArray(e))return!1;const n=e.length;if(7!==n)return!1;for(let t=0;t<n;t++){const n=e[t];if(!(n instanceof Uint8Array))return!1;const a=n.length;if(7!==a)return!1;for(let e=0;e<a;e++){const a=n[e];if(0!==a&&1!==a&&2!==a)return!1;if(2===o[t][e]!=(2===a))return!1}}return!0},copyPuzzle:e=>{const t=[];for(let o=0;o<7;o++)t[o]=new Uint8Array(e[o]);return Object.seal(t),t},codeToPuzzle:(e,o=36)=>{const n=2===o?e:c(e,o,2),a=t();let r=0;for(let e=0;e<7;e++){const t=a[e];for(let e=0;e<7;e++)2!==t[e]&&(t[e]=n[r],r++)}return a},puzzleToCode:(e,t=36)=>{let o="";for(let t=0;t<7;t++){const n=e[t];for(let e=0;e<7;e++){const t=n[e];2!==t&&(o+=t)}}return 2===t?o:c(o,2,t)},convertCodeBase:c,defaultCodeBase:36,transform:r,isometryCount:a,codeImages:e=>{const t=new Set;t.add(e);for(let o=0;o<a;o++)t.add(r(e,o));return Array.from(t)},countBalls:e=>{let t=0;for(let o=0;o<7;o++)for(let n=0;n<7;n++)1===e[o][n]&&t++;return t},codeSampleRange:m,sampleCode:e=>{let t="";for(let o=0;o<h;o++)t+=e.charAt(u[o]);return parseInt(t,2)},validateMoveStruct:e=>e&&e.from&&"number"==typeof e.from.x&&"number"==typeof e.from.y&&e.to&&"number"==typeof e.to.x&&"number"==typeof e.from.y}}},t={};function o(n){var a=t[n];if(void 0!==a)return a.exports;var r=t[n]={exports:{}};return e[n](r,r.exports,o),r.exports}(()=>{const e=o(273),{useState:t,createRef:n}=React,a=()=>{const o=[{value:"toggleBalls",name:"Toggle balls manually"},{value:"solveReverse",name:"Solve in reverse"}],a=o[0].value,[r,l]=t(a),s=n(),i=n(),c=`${"0".repeat(16)}1${"0".repeat(16)}`;return React.createElement(React.Fragment,null,React.createElement(e,{ref:s,basis:c,editMode:a}),React.createElement("h3",null,"Edit mode"),React.createElement("div",{className:"editModeContainer"},o.map(((e,t)=>React.createElement("div",{className:"form-check",key:t},React.createElement("input",{className:"form-check-input",type:"radio",name:"editMode",checked:r===e.value,onChange:()=>(e=>{s.current.editMode=e,l(e)})(e.value)}),React.createElement("label",{htmlFor:"toggleBall"},e.name))))),React.createElement("div",{className:"buttonContainerFlex buttonContainerVert"},React.createElement("button",{id:"undoButton",type:"button",className:"btn btn-secondary btn-lg",onClick:()=>s.current.undo()},React.createElement("i",{className:"fa-solid fa-arrow-rotate-left"})," Undo"),React.createElement("h3",{className:"spacedHeader"},"Name and upload"),React.createElement("input",{type:"text",ref:i}),React.createElement("button",{type:"button",className:"btn btn-success btn-lg",onClick:()=>console.log(s.current.code(),i.current.value)},React.createElement("i",{className:"fa-solid fa-upload"})," Upload")))};window.onload=()=>{const e=document.getElementById("createUI");ReactDOM.createRoot(e).render(React.createElement(a,null))}})()})();